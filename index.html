<!DOCTYPE html>
<html>
<head>
  <title>Code Snippet Wrapper</title>
  <script src="https://unpkg.com/shiki@0.9.10/dist/index.unpkg.iife.js"></script>
  
  <link rel="stylesheet" type="text/css" href="https://tympanus.net/Development/ButtonStylesInspiration/css/vicons-font.css" />
  
  <style>
body {
  margin:0;
  padding:0;
}
.body-wrapper {
  display: flex;
}

    .code-container {
      margin-bottom: 10px;
    }

    .copy-button {
      margin-top: 10px;
    }

    .code-container code {
      overflow: auto;
      height: 200px; /* Adjust the height as desired */
      width: 100%; /* Adjust the width as desired */
    }

pre {
  padding: 1em;
          background: #131418 !important;
          margin-bottom: 0 !important;
}

.main-navigation {
  width:300px;
  background: #131418;
  height:100vh;
  border-right: 1px solid #eeeeee0a;
  padding:10px;
}

.code-block {
  padding: 1rem;
    background: #030303;
  width:100%;
}
    pre.shiki {
        background: #131418 !important;
          margin-bottom: 0 !important;
    }
    button.copy-button {
                margin-top: 0 !important;
    }
    
    .main-navigation #repeaterFieldName,
    .main-navigation input#additionalValue,
    .main-navigation textarea#codeSnippet {
      padding:10px 5px 10px 10px;
      width:90%;
      background:#000;
      border:none;
      border-bottom: 1px solid #88C0D0;
      margin-bottom: 10px;
    }
    textarea#codeSnippet {
      height:300px;
    }
    
    
    

/* Nina */
.button--nina {
	padding: 0 5px;
  width: 100%;
	background: #1a2041;
	color: #fff;
	overflow: hidden;
	-webkit-transition: background-color 0.3s;
	transition: background-color 0.3s;
  position:relative;
  border:none;
}
.button--nina.button--inverted {
	background: #fff;
	color: #7986cb;
}
.button--nina > span {
	display: inline-block;
	padding: 1em 0;
	opacity: 0;
	color: #fff;
	-webkit-transform: translate3d(0, -10px, 0);
	transform: translate3d(0, -10px, 0);
	-webkit-transition: -webkit-transform 0.3s, opacity 0.3s;
	transition: transform 0.3s, opacity 0.3s;
	-webkit-transition-timing-function: cubic-bezier(0.75, 0, 0.125, 1);
	transition-timing-function: cubic-bezier(0.75, 0, 0.125, 1);
}
.button--nina::before {
	content: attr(data-text);
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	padding: 1em 0;
	-webkit-transition: -webkit-transform 0.3s, opacity 0.3s;
	transition: transform 0.3s, opacity 0.3s;
	-webkit-transition-timing-function: cubic-bezier(0.75, 0, 0.125, 1);
	transition-timing-function: cubic-bezier(0.75, 0, 0.125, 1);
}
.button--nina:hover {
	background-color: #3f51b5;
  cursor:pointer;
}
.button--nina:hover::before {
	opacity: 0;
	-webkit-transform: translate3d(0, 100%, 0);
	transform: translate3d(0, 100%, 0);
}
.button--nina:hover > span {
	opacity: 1;
	-webkit-transform: translate3d(0, 0, 0);
	transform: translate3d(0, 0, 0);
}
.button--nina:hover > span:nth-child(1) {
	-webkit-transition-delay: 0.045s;
	transition-delay: 0.045s;
}
.button--nina:hover > span:nth-child(2) {
	-webkit-transition-delay: 0.09s;
	transition-delay: 0.09s;
}
.button--nina:hover > span:nth-child(3) {
	-webkit-transition-delay: 0.135s;
	transition-delay: 0.135s;
}
.button--nina:hover > span:nth-child(4) {
	-webkit-transition-delay: 0.18s;
	transition-delay: 0.18s;
}
.button--nina:hover > span:nth-child(5) {
	-webkit-transition-delay: 0.225s;
	transition-delay: 0.225s;
}
.button--nina:hover > span:nth-child(6) {
	-webkit-transition-delay: 0.27s;
	transition-delay: 0.27s;
}
.button--nina:hover > span:nth-child(7) {
	-webkit-transition-delay: 0.315s;
	transition-delay: 0.315s;
}
.button--nina:hover > span:nth-child(8) {
	-webkit-transition-delay: 0.36s;
	transition-delay: 0.36s;
}
.button--nina:hover > span:nth-child(9) {
	-webkit-transition-delay: 0.405s;
	transition-delay: 0.405s;
}
.button--nina:hover > span:nth-child(10) {
	-webkit-transition-delay: 0.45s;
	transition-delay: 0.45s;
}
  </style>
  
</head>
<body>
  <div class="body-wrapper">
  <div class="main-navigation">
    <textarea id="codeSnippet" placeholder="Enter HTML code here"></textarea>
    <input type="text" id="repeaterFieldName" placeholder="Repeater Field Name">
    <input type="text" id="additionalValue" placeholder="Additional Value">
    
<button onclick="appendCode()" class="button button--nina button--text-thick button--text-upper button--size-s" data-text="Create">
						<span>C</span><span>r</span><span>e</span><span>a</span><span>t</span><span>e</span>
					</button>
    </div>
  <div class="code-block">
    <div id="codeContainer"></div>
  </div>
    </div>

  <script>
    const appendCode = async () => {
      const codeSnippet = document.getElementById('codeSnippet').value;
      const repeaterFieldName = document.getElementById('repeaterFieldName').value;
      const additionalValue = document.getElementById('additionalValue').value;

      const additionalValues = additionalValue.split(',').map(value => value.trim());

      const wrappedCode = wrapWithRepeaterLoop(codeSnippet, repeaterFieldName, additionalValues);

      const codeContainer = document.createElement('div');
      codeContainer.className = 'code-container';

      const codeBlock = document.createElement('code');
      codeBlock.textContent = wrappedCode;

      codeContainer.appendChild(codeBlock);

      const copyButton = document.createElement('button');
      copyButton.className = 'copy-button';
      copyButton.textContent = 'Copy';
      copyButton.addEventListener('click', () => {
        copyToClipboard(wrappedCode);
      });

      codeContainer.appendChild(copyButton);

      const codeContainerElement = document.getElementById('codeContainer');
      codeContainerElement.appendChild(codeContainer);

      const highlighter = await shiki.getHighlighter({ theme: 'nord' });
      const language = 'php';
      const code = highlighter.codeToHtml(wrappedCode, language);
      codeBlock.innerHTML = code;
    };

    const wrapWithRepeaterLoop = (codeBlock, repeaterFieldName, additionalValues) => {
      let repeaterCode = '';

      repeaterCode += `<?php if (have_rows('${repeaterFieldName}')) : while (have_rows('${repeaterFieldName}')) : the_row(); ?>\n`;
      repeaterCode += `${codeBlock}\n`;

      additionalValues.forEach(additionalValue => {
        repeaterCode += `<?= get_sub_field('${additionalValue}'); ?>\n`;
      });

      repeaterCode += '<?php endwhile; endif; ?>';

      return repeaterCode;
    };

    const copyToClipboard = text => {
      const textarea = document.createElement('textarea');
      textarea.value = text;
      document.body.appendChild(textarea);
      textarea.select();
      document.execCommand('copy');
      document.body.removeChild(textarea);
      alert('Code copied to clipboard!');
    };
  </script>
</body>
</html>
